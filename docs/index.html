<h1 id="deep-mutational-scanning-of-sars-cov-2-ba2-spike-using-a-barcoded-lentiviral-platform">Deep mutational scanning of SARS-CoV-2 BA.2 spike using a barcoded lentiviral platform</h1>
<p>Analysis by Bernadeta Dadonaite and Jesse Bloom (2023)</p>
<p>See <a href="https://github.com/dms-vep/SARS-CoV-2_Omicron_BA.2_spike_ACE2_affinity">https://github.com/dms-vep/SARS-CoV-2_Omicron_BA.2_spike_ACE2_affinity</a> for full code.</p>
<div class="toc"><span class="toctitle">Contents</span><ul>
<li><a href="#barcode-to-codon-variant-lookup-table">Barcode to codon-variant lookup table</a></li>
<li><a href="#count-barcodes-for-variants">Count barcodes for variants</a></li>
<li><a href="#functional-effects-of-mutations">Functional effects of mutations</a></li>
<li><a href="#receptor-affinity">Receptor affinity</a></li>
<li><a href="#summary-of-results-across-assays">Summary of results across assays</a></li>
<li><a href="#additional-data-files">Additional data files</a></li>
</ul>
</div>
<h2 id="barcode-to-codon-variant-lookup-table">Barcode to codon-variant lookup table</h2>
<h4 id="analysis-notebooks">Analysis notebooks</h4>
<ul>
<li><a href="notebooks/analyze_pacbio_ccs.html">Analysis of PacBio CCSs</a></li>
<li><a href="notebooks/build_pacbio_consensus.html">Building barcoded variant consensus sequences</a></li>
<li><a href="notebooks/build_codon_variants.html">Building of codon-variant table</a></li>
</ul>
<h4 id="data-files">Data files</h4>
<ul>
<li><a href="https://github.com/dms-vep/SARS-CoV-2_Omicron_BA.2_spike_ACE2_affinity/blob/main/results/gene_sequence/codon.fasta">parental codon sequence</a></li>
<li><a href="https://github.com/dms-vep/SARS-CoV-2_Omicron_BA.2_spike_ACE2_affinity/blob/main/results/gene_sequence/protein.fasta">parental protein sequence</a></li>
<li><a href="https://github.com/dms-vep/SARS-CoV-2_Omicron_BA.2_spike_ACE2_affinity/blob/main/results/variants/codon_variants.csv">barcode to codon-variant lookup table</a></li>
</ul>
<h2 id="count-barcodes-for-variants">Count barcodes for variants</h2>
<h4 id="analysis-notebooks_1">Analysis notebooks</h4>
<ul>
<li><a href="notebooks/analyze_variant_counts.html">Analysis of variant counts</a></li>
</ul>
<h4 id="data-files_1">Data files</h4>
<ul>
<li><details><summary>Barcode count CSVs (click triangle to expand/collapse)</summary><ul>

<li><a href="https://github.com/dms-vep/SARS-CoV-2_Omicron_BA.2_spike_ACE2_affinity/blob/main/results/barcode_counts/Lib1-221022-VSVG_control_293T_counts.csv">Lib1-221022-VSVG_control_293T</a></li>
<li><a href="https://github.com/dms-vep/SARS-CoV-2_Omicron_BA.2_spike_ACE2_affinity/blob/main/results/barcode_counts/Lib2-221022-VSVG_control_293T_counts.csv">Lib2-221022-VSVG_control_293T</a></li>
<li><a href="https://github.com/dms-vep/SARS-CoV-2_Omicron_BA.2_spike_ACE2_affinity/blob/main/results/barcode_counts/Lib1-221022-no-antibody_control_highACE2_counts.csv">Lib1-221022-no-antibody_control_highACE2</a></li>
<li><a href="https://github.com/dms-vep/SARS-CoV-2_Omicron_BA.2_spike_ACE2_affinity/blob/main/results/barcode_counts/Lib2-221022-no-antibody_control_highACE2_counts.csv">Lib2-221022-no-antibody_control_highACE2</a></li>
<li><a href="https://github.com/dms-vep/SARS-CoV-2_Omicron_BA.2_spike_ACE2_affinity/blob/main/results/barcode_counts/Lib1-221023-VSVG_control_293T_counts.csv">Lib1-221023-VSVG_control_293T</a></li>
<li><a href="https://github.com/dms-vep/SARS-CoV-2_Omicron_BA.2_spike_ACE2_affinity/blob/main/results/barcode_counts/Lib2-221023-VSVG_control_293T_counts.csv">Lib2-221023-VSVG_control_293T</a></li>
<li><a href="https://github.com/dms-vep/SARS-CoV-2_Omicron_BA.2_spike_ACE2_affinity/blob/main/results/barcode_counts/Lib1-221023-no-antibody_control_highACE2_counts.csv">Lib1-221023-no-antibody_control_highACE2</a></li>
<li><a href="https://github.com/dms-vep/SARS-CoV-2_Omicron_BA.2_spike_ACE2_affinity/blob/main/results/barcode_counts/Lib2-221023-no-antibody_control_highACE2_counts.csv">Lib2-221023-no-antibody_control_highACE2</a></li>
<li><a href="https://github.com/dms-vep/SARS-CoV-2_Omicron_BA.2_spike_ACE2_affinity/blob/main/results/barcode_counts/Lib2-230105-no-antibody_control_mediumACE2_counts.csv">Lib2-230105-no-antibody_control_mediumACE2</a></li>
<li><a href="https://github.com/dms-vep/SARS-CoV-2_Omicron_BA.2_spike_ACE2_affinity/blob/main/results/barcode_counts/Lib2-230105-antibody_2.88_mediumACE2_counts.csv">Lib2-230105-antibody_2.88_mediumACE2</a></li>
<li><a href="https://github.com/dms-vep/SARS-CoV-2_Omicron_BA.2_spike_ACE2_affinity/blob/main/results/barcode_counts/Lib2-230105-antibody_8.633016_mediumACE2_counts.csv">Lib2-230105-antibody_8.633016_mediumACE2</a></li>
<li><a href="https://github.com/dms-vep/SARS-CoV-2_Omicron_BA.2_spike_ACE2_affinity/blob/main/results/barcode_counts/Lib2-230105-antibody_25.899048_mediumACE2_counts.csv">Lib2-230105-antibody_25.899048_mediumACE2</a></li>
<li><a href="https://github.com/dms-vep/SARS-CoV-2_Omicron_BA.2_spike_ACE2_affinity/blob/main/results/barcode_counts/Lib2-230105-antibody_77.697144_mediumACE2_counts.csv">Lib2-230105-antibody_77.697144_mediumACE2</a></li>
<li><a href="https://github.com/dms-vep/SARS-CoV-2_Omicron_BA.2_spike_ACE2_affinity/blob/main/results/barcode_counts/Lib2-230105-antibody_233.091432_mediumACE2_counts.csv">Lib2-230105-antibody_233.091432_mediumACE2</a></li>
<li><a href="https://github.com/dms-vep/SARS-CoV-2_Omicron_BA.2_spike_ACE2_affinity/blob/main/results/barcode_counts/Lib1-230114-no-antibody_control_mediumACE2_counts.csv">Lib1-230114-no-antibody_control_mediumACE2</a></li>
<li><a href="https://github.com/dms-vep/SARS-CoV-2_Omicron_BA.2_spike_ACE2_affinity/blob/main/results/barcode_counts/Lib1-230114-antibody_1.8_mediumACE2_counts.csv">Lib1-230114-antibody_1.8_mediumACE2</a></li>
<li><a href="https://github.com/dms-vep/SARS-CoV-2_Omicron_BA.2_spike_ACE2_affinity/blob/main/results/barcode_counts/Lib1-230114-antibody_5.4_mediumACE2_counts.csv">Lib1-230114-antibody_5.4_mediumACE2</a></li>
<li><a href="https://github.com/dms-vep/SARS-CoV-2_Omicron_BA.2_spike_ACE2_affinity/blob/main/results/barcode_counts/Lib1-230114-antibody_16.2_mediumACE2_counts.csv">Lib1-230114-antibody_16.2_mediumACE2</a></li>
<li><a href="https://github.com/dms-vep/SARS-CoV-2_Omicron_BA.2_spike_ACE2_affinity/blob/main/results/barcode_counts/Lib1-230114-antibody_48.6_mediumACE2_counts.csv">Lib1-230114-antibody_48.6_mediumACE2</a></li>
<li><a href="https://github.com/dms-vep/SARS-CoV-2_Omicron_BA.2_spike_ACE2_affinity/blob/main/results/barcode_counts/Lib1-230114-antibody_145.8_mediumACE2_counts.csv">Lib1-230114-antibody_145.8_mediumACE2</a></li>
</ul></details>

</li>
</ul>
<h2 id="functional-effects-of-mutations">Functional effects of mutations</h2>
<h4 id="final-summary-plots">Final summary plots</h4>
<ul>
<li><details><summary>Interactive plots of average mutation functional effects (click triangle to expand/collapse)</summary><ul>

<li><a href="htmls/293T_high_ACE2_entry_func_effects.html">293T_high_ACE2_entry</a></li>
</ul></details>

</li>
<li><details><summary>Interactive plots of average mutation latent-phenotype effects (click triangle to expand/collapse)</summary><ul>

<li><a href="htmls/293T_high_ACE2_entry_latent_effects.html">293T_high_ACE2_entry</a></li>
</ul></details>

</li>
</ul>
<h4 id="analysis-notebooks_2">Analysis notebooks</h4>
<ul>
<li><a href="notebooks/analyze_func_scores.html">Analysis of functional scores</a></li>
<li><details><summary>Notebooks with per-selection global epistasis fitting (click triangle to expand/collapse)</summary><ul>

<li><a href="notebooks/func_effects_global_epistasis_Lib1-221022_high_ACE2.html">Lib1-221022_high_ACE2</a></li>
<li><a href="notebooks/func_effects_global_epistasis_Lib2-221022_high_ACE2.html">Lib2-221022_high_ACE2</a></li>
<li><a href="notebooks/func_effects_global_epistasis_Lib1-221023_high_ACE2.html">Lib1-221023_high_ACE2</a></li>
<li><a href="notebooks/func_effects_global_epistasis_Lib2-221023_high_ACE2.html">Lib2-221023_high_ACE2</a></li>
</ul></details>

</li>
<li><details><summary>Notebooks averaging mutation functional effects (click triangle to expand/collapse)</summary><ul>

<li><a href="notebooks/avg_func_effects_293T_high_ACE2_entry.html">293T_high_ACE2_entry</a></li>
</ul></details>

</li>
</ul>
<h4 id="data-files_2">Data files</h4>
<ul>
<li><details><summary>Per-variant functional score CSVs (click triangle to expand/collapse)</summary><ul>

<li><a href="https://github.com/dms-vep/SARS-CoV-2_Omicron_BA.2_spike_ACE2_affinity/blob/main/results/func_scores/Lib1-221022_high_ACE2_func_scores.csv">Lib1-221022_high_ACE2</a></li>
<li><a href="https://github.com/dms-vep/SARS-CoV-2_Omicron_BA.2_spike_ACE2_affinity/blob/main/results/func_scores/Lib2-221022_high_ACE2_func_scores.csv">Lib2-221022_high_ACE2</a></li>
<li><a href="https://github.com/dms-vep/SARS-CoV-2_Omicron_BA.2_spike_ACE2_affinity/blob/main/results/func_scores/Lib1-221023_high_ACE2_func_scores.csv">Lib1-221023_high_ACE2</a></li>
<li><a href="https://github.com/dms-vep/SARS-CoV-2_Omicron_BA.2_spike_ACE2_affinity/blob/main/results/func_scores/Lib2-221023_high_ACE2_func_scores.csv">Lib2-221023_high_ACE2</a></li>
</ul></details>

</li>
<li><details><summary>Per-selection mutation functional effect CSVs (click triangle to expand/collapse)</summary><ul>

<li><a href="https://github.com/dms-vep/SARS-CoV-2_Omicron_BA.2_spike_ACE2_affinity/blob/main/results/func_effects/by_selection/Lib1-221022_high_ACE2_func_effects.csv">Lib1-221022_high_ACE2</a></li>
<li><a href="https://github.com/dms-vep/SARS-CoV-2_Omicron_BA.2_spike_ACE2_affinity/blob/main/results/func_effects/by_selection/Lib2-221022_high_ACE2_func_effects.csv">Lib2-221022_high_ACE2</a></li>
<li><a href="https://github.com/dms-vep/SARS-CoV-2_Omicron_BA.2_spike_ACE2_affinity/blob/main/results/func_effects/by_selection/Lib1-221023_high_ACE2_func_effects.csv">Lib1-221023_high_ACE2</a></li>
<li><a href="https://github.com/dms-vep/SARS-CoV-2_Omicron_BA.2_spike_ACE2_affinity/blob/main/results/func_effects/by_selection/Lib2-221023_high_ACE2_func_effects.csv">Lib2-221023_high_ACE2</a></li>
</ul></details>

</li>
<li><details><summary>Average mutation functional effects (CSV files) (click triangle to expand/collapse)</summary><ul>

<li><a href="https://github.com/dms-vep/SARS-CoV-2_Omicron_BA.2_spike_ACE2_affinity/blob/main/results/func_effects/averages/293T_high_ACE2_entry_func_effects.csv">293T_high_ACE2_entry</a></li>
</ul></details>

</li>
<li><details><summary>Average mutation latent-phenotype effects (CSV files) (click triangle to expand/collapse)</summary><ul>

<li><a href="https://github.com/dms-vep/SARS-CoV-2_Omicron_BA.2_spike_ACE2_affinity/blob/main/results/func_effects/averages/293T_high_ACE2_entry_func_effects.csv">293T_high_ACE2_entry</a></li>
</ul></details>

</li>
</ul>
<h2 id="receptor-affinity">Receptor affinity</h2>
<h4 id="final-summary-plots_1">Final summary plots</h4>
<ul>
<li><details><summary>receptor affinity mutation effect plots (click triangle to expand/collapse)</summary><ul>

<li><a href="htmls/monomeric_ACE2_mut_effect.html">monomeric_ACE2</a></li>
</ul></details>

</li>
</ul>
<h4 id="analysis-notebooks_3">Analysis notebooks</h4>
<ul>
<li><details><summary>Fits of polyclonal models to individual receptor affinity selections (click triangle to expand/collapse)</summary><ul>

<li><a href="notebooks/fit_escape_receptor_affinity_Lib1-230114-monomeric_ACE2.html">Lib1-230114-monomeric_ACE2</a></li>
<li><a href="notebooks/fit_escape_receptor_affinity_Lib2-230105-monomeric_ACE2.html">Lib2-230105-monomeric_ACE2</a></li>
</ul></details>

</li>
<li><details><summary>Average selections for receptor affinity (click triangle to expand/collapse)</summary><ul>

<li><a href="notebooks/avg_escape_receptor_affinity_monomeric_ACE2.html">monomeric_ACE2</a></li>
</ul></details>

</li>
</ul>
<h4 id="data-files_3">Data files</h4>
<ul>
<li><details><summary>Probability (fraction) escape for each variant in each receptor affinity selection (CSVs) (click triangle to expand/collapse)</summary><ul>

<li><a href="https://github.com/dms-vep/SARS-CoV-2_Omicron_BA.2_spike_ACE2_affinity/blob/main/results/receptor_affinity/by_selection/Lib1-230114-monomeric_ACE2/Lib1-230114-antibody_1.8_mediumACE2_prob_escape.csv">Lib1-230114-monomeric_ACE2 Lib1-230114-antibody_1.8_mediumACE2</a></li>
<li><a href="https://github.com/dms-vep/SARS-CoV-2_Omicron_BA.2_spike_ACE2_affinity/blob/main/results/receptor_affinity/by_selection/Lib1-230114-monomeric_ACE2/Lib1-230114-antibody_5.4_mediumACE2_prob_escape.csv">Lib1-230114-monomeric_ACE2 Lib1-230114-antibody_5.4_mediumACE2</a></li>
<li><a href="https://github.com/dms-vep/SARS-CoV-2_Omicron_BA.2_spike_ACE2_affinity/blob/main/results/receptor_affinity/by_selection/Lib1-230114-monomeric_ACE2/Lib1-230114-antibody_16.2_mediumACE2_prob_escape.csv">Lib1-230114-monomeric_ACE2 Lib1-230114-antibody_16.2_mediumACE2</a></li>
<li><a href="https://github.com/dms-vep/SARS-CoV-2_Omicron_BA.2_spike_ACE2_affinity/blob/main/results/receptor_affinity/by_selection/Lib1-230114-monomeric_ACE2/Lib1-230114-antibody_48.6_mediumACE2_prob_escape.csv">Lib1-230114-monomeric_ACE2 Lib1-230114-antibody_48.6_mediumACE2</a></li>
<li><a href="https://github.com/dms-vep/SARS-CoV-2_Omicron_BA.2_spike_ACE2_affinity/blob/main/results/receptor_affinity/by_selection/Lib1-230114-monomeric_ACE2/Lib1-230114-antibody_145.8_mediumACE2_prob_escape.csv">Lib1-230114-monomeric_ACE2 Lib1-230114-antibody_145.8_mediumACE2</a></li>
<li><a href="https://github.com/dms-vep/SARS-CoV-2_Omicron_BA.2_spike_ACE2_affinity/blob/main/results/receptor_affinity/by_selection/Lib2-230105-monomeric_ACE2/Lib2-230105-antibody_2.88_mediumACE2_prob_escape.csv">Lib2-230105-monomeric_ACE2 Lib2-230105-antibody_2.88_mediumACE2</a></li>
<li><a href="https://github.com/dms-vep/SARS-CoV-2_Omicron_BA.2_spike_ACE2_affinity/blob/main/results/receptor_affinity/by_selection/Lib2-230105-monomeric_ACE2/Lib2-230105-antibody_8.633016_mediumACE2_prob_escape.csv">Lib2-230105-monomeric_ACE2 Lib2-230105-antibody_8.633016_mediumACE2</a></li>
<li><a href="https://github.com/dms-vep/SARS-CoV-2_Omicron_BA.2_spike_ACE2_affinity/blob/main/results/receptor_affinity/by_selection/Lib2-230105-monomeric_ACE2/Lib2-230105-antibody_25.899048_mediumACE2_prob_escape.csv">Lib2-230105-monomeric_ACE2 Lib2-230105-antibody_25.899048_mediumACE2</a></li>
<li><a href="https://github.com/dms-vep/SARS-CoV-2_Omicron_BA.2_spike_ACE2_affinity/blob/main/results/receptor_affinity/by_selection/Lib2-230105-monomeric_ACE2/Lib2-230105-antibody_77.697144_mediumACE2_prob_escape.csv">Lib2-230105-monomeric_ACE2 Lib2-230105-antibody_77.697144_mediumACE2</a></li>
<li><a href="https://github.com/dms-vep/SARS-CoV-2_Omicron_BA.2_spike_ACE2_affinity/blob/main/results/receptor_affinity/by_selection/Lib2-230105-monomeric_ACE2/Lib2-230105-antibody_233.091432_mediumACE2_prob_escape.csv">Lib2-230105-monomeric_ACE2 Lib2-230105-antibody_233.091432_mediumACE2</a></li>
</ul></details>

</li>
<li><details><summary>receptor affinity CSVs (click triangle to expand/collapse)</summary><ul>

<li><a href="https://github.com/dms-vep/SARS-CoV-2_Omicron_BA.2_spike_ACE2_affinity/blob/main/results/receptor_affinity/averages/monomeric_ACE2_mut_effect.csv">monomeric_ACE2</a></li>
</ul></details>

</li>
</ul>
<h2 id="summary-of-results-across-assays">Summary of results across assays</h2>
<h4 id="final-summary-plots_2">Final summary plots</h4>
<ul>
<li><a href="htmls/summary_overlaid.html">Summary of assays</a></li>
</ul>
<h4 id="data-files_4">Data files</h4>
<ul>
<li><a href="https://github.com/dms-vep/SARS-CoV-2_Omicron_BA.2_spike_ACE2_affinity/blob/main/results/summaries/summary.csv">CSV summarizing results</a></li>
</ul>
<h2 id="additional-data-files">Additional data files</h2>
<h4 id="spike-site-numbering">Spike site numbering</h4>
<ul>
<li><a href="https://github.com/dms-vep/SARS-CoV-2_Omicron_BA.2_spike_ACE2_affinity/blob/main/data/site_numbering_map.csv">CSV converting sequential sites in XBB.1.5 spike to Wuhan-Hu-1 reference sites</a></li>
</ul>